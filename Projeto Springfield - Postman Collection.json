{
  "info": {
    "_postman_id": "16014a24-ce59-4151-b948-a97dbaa0a086",
    "name": "Projeto Cidade Springfield - API Completa",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "42751641"
  },
  "item": [
    {
      "name": "1. Gerenciamento de Cidadãos",
      "item": [
        {
          "name": "1.1 Listar todos os cidadãos",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:8080/cidadaos",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["cidadaos"]
            }
          },
          "response": []
        },
        {
          "name": "1.2 Buscar um cidadão por ID (Ex: 10001)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:8080/cidadaos/10001",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["cidadaos", "10001"]
            }
          },
          "response": []
        },
        {
          "name": "1.3 Cadastrar um novo cidadão",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\r\n  \"nome\": \"Bart Simpson\",\r\n  \"endereco\": \"742 Evergreen Terrace\",\r\n  \"bairro\": \"Centro\"\r\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://localhost:8080/cidadaos",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["cidadaos"]
            }
          },
          "response": []
        },
        {
          "name": "1.4 Atualizar um Cidadão (Ex: ID do Bart)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\r\n  \"nome\": \"Bartholomew J. Simpson\",\r\n  \"endereco\": \"Rua das Palmeiras, 999\",\r\n  \"bairro\": \"Vila Nova\"\r\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://localhost:8080/cidadaos/{{id_cidadao_cadastrado}}",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["cidadaos", "{{id_cidadao_cadastrado}}"],
              "description": "Substitua {{id_cidadao_cadastrado}} pelo ID retornado ao cadastrar o cidadão."
            }
          },
          "response": []
        },
        {
          "name": "1.5 Deletar um Cidadão (Ex: ID do Bart)",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "http://localhost:8080/cidadaos/{{id_cidadao_cadastrado}}",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["cidadaos", "{{id_cidadao_cadastrado}}"],
              "description": "Substitua {{id_cidadao_cadastrado}} pelo ID do cidadão a ser deletado."
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "2. Gerenciamento de Usuários",
      "item": [
        {
          "name": "2.1 Cadastrar Usuário (Ex: para Cid 10002)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData && jsonData.id) {",
                  "    pm.collectionVariables.set(\"id_usuario_cadastrado\", jsonData.id);",
                  "    console.log(\"Variável 'id_usuario_cadastrado' definida como: \" + jsonData.id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\r\n  \"idCidadao\": 10002,\r\n  \"username\": \"marge.simpson\",\r\n  \"senha\": \"bluehair\"\r\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://localhost:8080/usuarios/cadastro",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["usuarios", "cadastro"]
            }
          },
          "response": []
        },
        {
          "name": "2.2 Login de Usuário (Sucesso)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\r\n  \"username\": \"marge.simpson\",\r\n  \"senha\": \"bluehair\"\r\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://localhost:8080/usuarios/login",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["usuarios", "login"]
            }
          },
          "response": []
        },
        {
          "name": "2.3 Trocar a Senha do Usuário (Ex: Marge)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\r\n  \"novaSenha\": \"newbluehair789\"\r\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://localhost:8080/usuarios/{{id_usuario_cadastrado}}/trocar-senha",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["usuarios", "{{id_usuario_cadastrado}}", "trocar-senha"],
              "description": "Substitua {{id_usuario_cadastrado}} pelo ID retornado no cadastro do usuário."
            }
          },
          "response": []
        },
        {
          "name": "2.4 Desbloquear Usuário (Ex: Marge - Simular bloqueio antes)",
          "request": {
            "method": "PUT",
            "header": [],
            "url": {
              "raw": "http://localhost:8080/usuarios/{{id_usuario_cadastrado}}/desbloquear",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["usuarios", "{{id_usuario_cadastrado}}", "desbloquear"],
              "description": "Substitua {{id_usuario_cadastrado}}. Para testar bloqueio, erre o login 3x."
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "3. Solicitações (State Machine)",
      "item": [
        {
          "name": "3.1 Iniciar Nova Solicitação",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData && jsonData.demandaId) {",
                  "    pm.collectionVariables.set(\"demandaId_sm\", jsonData.demandaId);",
                  "    console.log(\"Variável 'demandaId_sm' definida como: \" + jsonData.demandaId);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"cidadaoId\": \"10001\", \n    \"descricao\": \"Reparo de poste de luz na Rua Principal\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://localhost:8080/solicitacoes",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["solicitacoes"]
            }
          },
          "response": []
        },
        {
          "name": "3.2 Processar Evento ANALISAR",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"evento\": \"ANALISAR\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://localhost:8080/solicitacoes/{{demandaId_sm}}/eventos",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["solicitacoes", "{{demandaId_sm}}", "eventos"]
            }
          },
          "response": []
        },
        {
          "name": "3.3 Processar Evento CONCLUIR",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"evento\": \"CONCLUIR\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://localhost:8080/solicitacoes/{{demandaId_sm}}/eventos",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["solicitacoes", "{{demandaId_sm}}", "eventos"]
            }
          },
          "response": []
        },
        {
          "name": "3.4 Buscar Histórico por Cidadão (Ex: 10001)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:8080/solicitacoes/cidadao/10001",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["solicitacoes", "cidadao", "10001"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "4. Comunicados Prefeitura (Kafka)",
      "item": [
        {
          "name": "4.1 Publicar Comunicado",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\r\n  \"titulo\": \"Alerta de Tempestade\",\r\n  \"mensagem\": \"Previsão de fortes chuvas para esta noite. Evitem áreas de risco.\",\r\n  \"remetente\": \"Defesa Civil de Springfield\"\r\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://localhost:8080/comunicados/publicar",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["comunicados", "publicar"]
            }
          },
          "response": []
        },
        {
          "name": "4.2 Visualizar Comunicados",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:8080/comunicados/visualizar",
              "protocol": "http",
              "host": ["localhost"],
              "port": "8080",
              "path": ["comunicados", "visualizar"]
            }
          },
          "response": []
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "id_cidadao_cadastrado",
      "value": "ID_AQUI",
      "type": "string",
      "description": "ID do cidadão retornado após o POST em /cidadaos"
    },
    {
      "key": "id_usuario_cadastrado",
      "value": "ID_AQUI",
      "type": "string",
      "description": "ID do usuário retornado após o POST em /usuarios/cadastro"
    },
    {
      "key": "demandaId_sm",
      "value": "UUID_AQUI",
      "type": "string",
      "description": "UUID da demanda retornado após o POST em /solicitacoes"
    }
  ]
}
